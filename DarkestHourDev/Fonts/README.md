# Fonts System

This guide will explain the system for generating and using fonts within Darkest Hour.

## History & Context

Unreal Engine 2 uses bitmap fonts to render text on the screen. These fonts are generated by executing a command within the SDK that will generate the font texture atlases and internal data structures for the font. These can be then referenced in the game code to render text on the screen using the font.

In the bad old days, this was all done by hand and was prone to errors that would be near impossible to fix because the process is finicky and there is no easily accessible documentation available.

Once the font had been generated, there were competing and incompatible systems for using the font in the game code that would not take into account the resolution or aspect ratio of the screen. 

This new system is designed to be as automated and easy to modify as possible, with a unified system for referencing the generated fonts in the game code.

## Font Generation

The batch file for generating fonts is found in the `tools\localization\generate_fonts.bat` file.

Executing this batch file will generate a text file full of commands that can be executed within the SDK using the following command:

```
EXEC "C:\Program Files (x86)\Steam\steamapps\common\Red Orchestra\DarkestHourDev\Fonts\ImportFonts.exec.txt"
```

> Note that the directory may be different on your system depending on where Red Orchestra is installed.
>
> Also note that all the fonts to be generated must be installed on the machine prior to executing the script within the SDK. This is because the SDK can only retrieve the fonts that are installed on the machine.

To execute the script file, press the "Show Full Log Window" button at the bottom left of the screen (to the right of the command prompt input) and copy-paste the command into the console and press enter.

This will generate the font atlases and data structures in the package specified in the `fonts.yml` file (`package_name` field).

It will also generate the UnrealScript classes for the fonts in the directory specified in `unrealscript.gui_fonts.directory` and `unrealscript.fonts.directory` in the `fonts.yml` file. 

The main way for accessing fonts is though the generated fonts class.  In Darkest Hour, this is the `DHFonts` class. A number of functions are generated for accessing the font styles in various ways. For example:

```unrealscript
class'DHFonts'.static.GetDHConsoleFontByResolution(Resolution);
```

This call will return a `Font` for the style `DHConsoleFont` that is appropriate for the resolution specified in the `Resolution` parameter (note that this is the `Y` (height) resolution).
